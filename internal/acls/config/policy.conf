# SPDX-FileCopyrightText: Â© 2021 Olivier Meunier <olivier@neokraft.net>
#
# SPDX-License-Identifier: AGPL-3.0-only

# -------------------------------------------------------------------
# Roles
# -------------------------------------------------------------------

# System routes
p, /system/read,    system, read

# Email sending
p, /email/send,     email, send

# Admin
p, /api/admin/read,     api:admin:users,    read
p, /api/admin/write,    api:admin:users,    write
p, /web/admin/read,     admin:users,        read
p, /web/admin/write,    admin:users,        write


# Cookbook
p, /api/cookbook/read,  api:cookbook,   read
p, /web/cookbook/read,  cookbook,       read

# Documentation
p, /web/docs/read,      docs,           read

# User profile
p, /api/profile/info,   api:profile,    info
p, /api/profile/read,   api:profile,    read
p, /api/profile/write,  api:profile,    write
p, /web/profile/read,   profile,        read
p, /web/profile/write,  profile,        write

# API Tokens
p, /api/profile/tokens/read,    api:profile:tokens, read
p, /api/profile/tokens/delete,  api:profile:tokens, delete
p, /web/profile/tokens/read,    profile:tokens,     read
p, /web/profile/tokens/write,   profile:tokens,     write


# Bookmarks
p, /api/bookmarks/read,     api:bookmarks,  read
p, /api/bookmarks/write,    api:bookmarks,  write
p, /api/bookmarks/export,   api:bookmarks,  export
p, /web/bookmarks/read,     bookmarks,      read
p, /web/bookmarks/write,    bookmarks,      write
p, /web/bookmarks/export,   bookmarks,      export

# Bookmark collections
p, /api/bookmarks/collections/read,     api:bookmarks:collections,  read
p, /api/bookmarks/collections/write,    api:bookmarks:collections,  write
p, /web/bookmarks/collections/read,     bookmarks:collections,      read
p, /web/bookmarks/collections/write,    bookmarks:collections,      write

# Bookmarks import
p, /api/bookmarks/import/write,  api:bookmarks:import,  write
p, /web/bookmarks/import/write,  bookmarks:import,      write

# OPDS catalog
p, /api/opds/read,  api:opds,   read


# -------------------------------------------------------------------
# Groups
# -------------------------------------------------------------------
# Note: the __group__ permission is a placeholder to identify
#       available groups.

# Empty group, for unauthenticated users
g,, /email/send

# These are needed for any groups or scope
g, api_common, /api/profile/info
g, api_common, /api/profile/tokens/delete


# Group "user"
g, user, __group__
g, user, api_common
g, user, /email/send
g, user, /*/docs/read
g, user, /*/profile/*
g, user, /*/profile/tokens/*
g, user, /*/bookmarks/read
g, user, /*/bookmarks/write
g, user, /*/bookmarks/export
g, user, /*/bookmarks/share
g, user, /*/bookmarks/collections/read
g, user, /*/bookmarks/collections/write
g, user, /*/bookmarks/import/write
g, user, /api/opds/*

# Group "staff"
g, staff, __group__
g, staff, user
g, staff, /system/*

# Group "admin"
g, admin, __group__
g, admin, staff
g, admin, /*/admin/*
g, admin, /*/cookbook/*


# -------------------------------------------------------------------
# Scoped roles (used for API tokens)
# -------------------------------------------------------------------
# Note: as with __group__, the __scope__ permission is a placeholder.

# Profile
g, profile:read, __token_scope__
g, profile:read, api_common
g, profile:read, /api/profile/read

# Bookmarks read only
g, bookmarks:read, __token_scope__
g, bookmarks:read, api_common
g, bookmarks:read, /api/bookmarks/read
g, bookmarks:read, /api/bookmarks/export
g, bookmarks:read, /api/bookmarks/collections/read
g, bookmarks:read, /api/opds/read
g, bookmarks:read, /web/bookmarks/read

# Bookmarks write only
g, bookmarks:write, __token_scope__
g, bookmarks:write, api_common
g, bookmarks:write, /api/bookmarks/write
g, bookmarks:write, /api/bookmarks/collections/write

# Admin read only
g, admin:read, __token_scope__
g, admin:read, api_common
g, admin:read, /api/admin/read
g, admin:read, /system/read

# Admin write only
g, admin:write, __token_scope__
g, admin:write, api_common
g, admin:write, /api/admin/write
