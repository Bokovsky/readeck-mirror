{*
SPDX-FileCopyrightText: Â© 2023 Olivier Meunier <olivier@neokraft.net>

SPDX-License-Identifier: AGPL-3.0-only
*}
{{ extends "/base" }}

{{- block title() -}}{{ gettext("API Documentation") }}{{- end -}}

{{- block head() -}}
  <script type="module" src="{{ assetURL(`vendor/rapidoc.js`) }}" nonce="{{ cspNonce }}"></script>
{{- end -}}

{{- block body() -}}
{{- yield quickAccessMenu(items=slice(
  slice("menu", "Menu"),
  slice("content", "Main content"),
)) -}}
<div class="max-w-layout flex h-screen max-sm:flex-col">
  {{ include "/menu" }}
  <div class="grow md:overflow-y-auto" id="content" lang="en-US">
    <rapi-doc
     spec-url="{{ .Schema }}"

     allow-server-selection="false"
     allow-spec-file-download="true"
     default-schema-tab="schema"
     info-description-headings-in-navbar="true"
     load-fonts="false"
     nav-bg-color="#ffffff"
     persist-auth="true"
     render-style="focus"
     schema-description-expanded="true"
     schema-style="tree"
     show-curl-before-try="true"
     show-header="false"
     show-method-in-nav-bar="as-colored-text"
     sort-endpoints-by="none"
     theme="light"
    >
      {{ yield breadcrumbs() }}
    </rapi-doc>
  </div>
</div>

<script nonce="{{ cspNonce }}">
if (window.innerWidth < 814) {
  document.querySelector("rapi-doc").setAttribute("render-style", "view")
}
</script>

{{ end }}
